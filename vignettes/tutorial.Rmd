---
title: "Project 3: myFirstPackage Tutorial"
author: "John Donovan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{myFirstPackage Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

Here, we introduce \texttt{myFirstPackage}, a package I made for a STAT302 final
project.

Install \texttt{myFirstPackage} using:
```{r, eval = FALSE}
devtools::install_github("johnbdonovan/myFirstPackage")
```

To begin, we load our example data set as a \texttt{gapminder} object. We will
also need the \texttt{tidyverse} package.
```{r, message = FALSE}
library(myFirstPackage)
library(gapminder)
library(tidyverse)
library(class)
```

# Conducting a t-test
Using the LifeExp data from gapminder we will conduct a t-test of 
$H_0 : \mu = 60$
$H_a : \mu \neq 60$
```{r}
data_t <- gapminder$lifeExp
my_t_test(data_t, "two.sided", 60)
```

Using the LifeExp data from gapminder we will conduct  a t-test of 
$H_0 : \mu = 60$
$H_a : \mu < 60$
```{r}
my_t_test(data_t, "less", 60)
```

Using the LifeExp data from gapminder we will conduct  a t-test of 
$H_0 : \mu = 60$
$H_a : \mu > 60$
```{r}
my_t_test(data_t, "greater", 60)
```

# Creating a linear regression model

Using the lifeExp data from gapminder as a response variable and gdpPercap and 
continent as explanatory variables.
```{r}
my_lm(lifeExp ~ gdpPercap + continent, gapminder)
```

```{r}
lm <- my_lm(lifeExp ~ gdpPercap + continent, gapminder)
model <- model.matrix(lifeExp ~ gdpPercap + continent, gapminder)%*%lm$Estimate
ggplot(data = cbind(gapminder, model), aes(x = model, y = lifeExp) ) +
  geom_point()
```


# Predicting with K-nearest neighbors

```{r}
CV <- numeric(10)
Train <- numeric(10)
for (n in 1:10) {
  CV[n] <- my_knn_cv(cbind(gapminder$gdpPercap, gapminder$lifeExp), 
          gapminder$continent, n, 5)$cv_err
  Train[n] <- my_knn_cv(cbind(gapminder$gdpPercap, gapminder$lifeExp), 
          gapminder$continent, n, 5)$train_err
}
cbind(CV, Train)
```

